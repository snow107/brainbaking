<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Hiding Code Complexity</title>
  
  <meta name="author" content="Wouter Groeneveld"/>
  <meta name="generator" content="Hugo 0.21" />
  <link href='http://www.brainbaking.com//img/favicon.ico' rel='icon' type='image/x-icon'/>

  <link rel="alternate" href="http://www.brainbaking.com/index.xml" type="application/rss+xml" title="Brain Baking">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/bootstrap.min.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://www.brainbaking.com//css/pygment_highlights.css" />
  <link rel="stylesheet" href="http://www.brainbaking.com/css/highlight.min.css">
  
  
  <meta property="og:title" content="Hiding Code Complexity" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/post/hiding-complexity/" />
  <meta property="og:image" content="/img/avatar-icon.png" />
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.brainbaking.com/">
        <i class="fa fa-lightbulb-o" aria-hidden="true"></i>&nbsp;&nbsp;
        Brain Baking
      </a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      <li id="google-search-wrapper">
	<script>
	(function() {
	  var cx = '015035874764642922467:uhhwew4ykvm';
	  var gcse = document.createElement('script');
	  gcse.type = 'text/javascript';
	  gcse.async = true;
	  gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	  var s = document.getElementsByTagName('script')[0];
	  s.parentNode.insertBefore(gcse, s);
	})();
	</script>

	<gcse:search></gcse:search>

	<form onsubmit="return false;">
		<label for="searchInput"><i class="fa fa-search" aria-hidden="true"></i><span class="sr-only">Search</span></label>
		<input type="text" id="searchInput" placeholder="Search">
	</form>

	<script>
	(function() {
		document.querySelector('#searchInput').addEventListener("keypress", function(event) {
			if(event.keyCode === 13) {
				event.stopPropagation();
				document.querySelector('#___gcse_0 input').value = document.querySelector('#searchInput').value;
				document.querySelector('.gsc-search-button input').click();

				var modal = document.querySelector('.gsc-modal-background-image');
				modal.attributes['class'].value = "gsc-modal-background-image gsc-modal-background-image-visible";
			}
		});
	})();
	</script>
</li>

      
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Menu</a>
            <div class="navlinks-children">
            
              <a href="/wiki/"><i class='fa fa-wikipedia-w'></i>&nbsp;&nbsp;Wiki</a>
            
              <a href="/tags"><i class='fa fa-tags'></i>&nbsp;&nbsp;Tags</a>
            
              <a href="/about"><i class='fa fa-address-card-o'></i>&nbsp;&nbsp;About me</a>
            
              <a href="/talks"><i class='fa fa-graduation-cap'></i>&nbsp;&nbsp;Talks</a>
            
              <a href="/books"><i class='fa fa-book' aria-hidden='true'></i>&nbsp;&nbsp;Books</a>
            
            </div>
          </li>
        
      
      </ul>
    </div>

	<div class="avatar-container">
	  <div class="avatar-img-border">
      
          <a title="Brain Baking" href="http://www.brainbaking.com/">
              <img class="avatar-img" src="http://www.brainbaking.com//img/avatar-icon.png" alt="Brain Baking" />
          </a>
      
	  </div>
	</div>

  </div>
</nav>

    



  
    <div id="header-big-imgs" data-num-img=1 data-img-src-1="/img/complexity.png"></div>
  

  <header class="header-section has-img">
  
    <div class="big-img intro-header">
        <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Hiding Code Complexity</h1>
      
        
      <h2 class="post-subheading">Do make it easy to read. Don&#39;t expose inner workings.</h2>
      
      
      
      
      <span class="post-meta">26 February 2018</span>
      
        </div>
      </div>
    </div>
  </div>
      <span class='img-desc'></span>
    </div>
  
  <div class="intro-header no-img">
      <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Hiding Code Complexity</h1>
      
        
      <h2 class="post-subheading">Do make it easy to read. Don&#39;t expose inner workings.</h2>
      
      
      
      
      <span class="post-meta">26 February 2018</span>
      
        </div>
      </div>
    </div>
  </div>
  </div>
  </header>


    <div class="container" role="main">	  
      
        <div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      
  <i class="fa fa-tags" style="float: left;" aria-hidden="true"></i>
  <ul id="tags">
  
   <li><a href="/tags/tech">tech</a> </li>
  
  </ul>



      <article role="main" class="blog-post">
          

<p>We like to talk about the architecture of our software because we like complexity. Software developers are the bears, and complex patterns seem to be the honey. The more I pair with people the more I wonder: &ldquo;what makes us decide to take on a simple question with a difficult answer&rdquo;? Why would anyone choose to implement something so complex, that it cannot be easily understood even the day after it&rsquo;s committed?</p>

<h4 id="answer-1-because-the-underlying-model-is-complex">Answer 1: because the underlying model is complex</h4>

<p><strong>Legacy</strong> systems. They always take the blame. But by introducing more complexity to work with, on the surface, we create even more legacy. The inner workings should never, ever, be exposed. I don&rsquo;t care about status 40 or 70 or 10 simply because it&rsquo;s persisted like that and you can&rsquo;t change it. That doesn&rsquo;t mean you should simply return that status and check the flags: instead we could try to <strong>hide that complex matter</strong> and encapsulate it in <strong>simple methods</strong>. That sounds simple. And it is. And yet, it almost never pops into people&rsquo;s minds.</p>

<p>Let&rsquo;s say that I&rsquo;ve written a system that, based on certain statuses, should execute an action. For instance, I can only delete something in my shopping cart if the status is 40, 53 or 70.</p>

<pre><code>    if(shoppingCart.status == 40 || shoppingCart.status == 53 || shoppingCart.status == 70) {
        delete();
    }
</code></pre>

<p>Extract method to the rescue:</p>

<pre><code>    if(isPossibleToDelete(shoppingCart)) {
        delete();
    }
    private bool isPossibleToDelete(shoppingCart) {
        return shoppingCart.status == 40 || shoppingCart.status == 53 || shoppingCart.status == 70
    }
</code></pre>

<p>But what do those numbers even mean?</p>

<pre><code>    private bool isPossibleToDelete(shoppingCart) {
        return shoppingCart.status == CartStatus.NEW_CART || shoppingCart.status == CartStatus.BLOCKED || shoppingCart.status == CartStatus.MERGED
    }
</code></pre>

<p>Ban those numbers to an enum and give them a <strong>meaningful name</strong>.<br/>
We&rsquo;re not done yet:</p>

<pre><code>    if(shoppingCart.isPossibleToDelete()) {
        delete();
    }
</code></pre>

<p>It&rsquo;s a subtle difference, but the cart knows about it&rsquo;s status and that means you can hide that complexity behind the ShoppingCart class implementation. Most developers will know enough if they read &ldquo;isPossibleToDelete&rdquo; and those who need to know the details can dive deep. See how simple that was? <strong>Hidden within a method</strong>, no other tricks used. Even if the underlying model still uses the ugly status checks, the rest of your software should never check on 40, 53 or 70 again. Ban those numbers to the enum and don&rsquo;t even use the enum values at your leisure.</p>

<p>If possible, go as far as making the status property private.</p>

<p>Another example. What if your legacy database structure doesn&rsquo;t allow an easy-to-read persistent layer but forces you to write in four different tables to get something done? The answer is the same as above: encapsulate everything. Don&rsquo;t simply implement (or generate, for that matter) CRUD operations based on your tables. Don&rsquo;t let your tables (or boss) rule your codebase!</p>

<pre><code>    public void Save(RosterClientLink link) {
        Persist(link);
        var client = GetClientById(link.client.Id);
        var roster = getRosterById(link.roster.Id);
        client.Rosters.Add(roster);
        Update(client);
    }
</code></pre>

<p>Having such a method gives away that you&rsquo;re leaning on a CRUD operation too much. The link class doesn&rsquo;t say anything and it&rsquo;s not even clear that it modifies client data unless you take a look. A second attempt:</p>

<pre><code>    public void attachWorkRosterToClient(Client client, Roster roster) {
        Persist(new RosterClientLink(client.Id, roster.Id));
        Persist(roster);
        client.Rosters.Add(roster);
        Update(client);
    }
</code></pre>

<p>Simply having this method is better than nothing - it makes the intention to attach the roster to a client visible. Instead of requiring every developer to know the inner workings of those tables, they can simply &ldquo;attach&rdquo;. Your business should also be speaking about &ldquo;attaching&rdquo; then. But again, we&rsquo;re not done yet:</p>

<pre><code>    public void attach(Roster roster) {
        Persist(new RosterClientLink(this.Id, roster.Id));
        Persist(roster);
        this.Rosters.Add(roster);
        Update(this);
    }
</code></pre>

<p>That makes <code>client.attach(roster);</code> possible, and that&rsquo;s easier to read and ultimately, understand. One could argue that <code>roster.attachTo(client)</code> makes more sense but think about <strong>responsibilities</strong> here: who owns what? Why would the roster be able to attach itself to a client, while a client owns and creates the rosters?</p>

<h4 id="answer-2-because-we-want-to-prove-ourselves">Answer 2: because we want to prove ourselves</h4>

<p>You might think you look cool if you can handle a pattern in a pattern. You might be proud of yourself once you managed to generalize one callback that will never be re-used. Hoping others would be proud of you to. If those others can&rsquo;t make much of your code, I would dare to say that it won&rsquo;t be the case.</p>

<p>Using a factory because you&rsquo;re convinced that creating <em>anything</em> has to be done by a factory might not be the best move to make. Using dependency injection because it&rsquo;s <em>best practice</em> doesn&rsquo;t make much sense to me either and that&rsquo;s a trap that almost everyone falls in. What&rsquo;s wrong with this:</p>

<pre><code>    public class Stuff {
        private readonly IDep _One;
        private readonly IDep two;

        public Stuff(IDep one, IDep two) {
            _One = one;
            _Two = two;
        }

        public Stuff() : this(new One(), new Two()) {

        }
    }
</code></pre>

<p>The first constructor is used in unit testing and allows us to <em>inject</em> (aha!) mocks into the loaded instance, while the second constructor is used in production. This approach has some drawbacks, like any other approach - like the cascading effect of object creation. But that might be enough for your application.</p>

<p><a href="https://en.wikipedia.org/wiki/KISS_principle">Keep it simple, stupid</a>.</p>

      </article>

      <ul class="blog-pagination blog-pager">
        
        <li>
          &larr; Previous Post: <a href="http://www.brainbaking.com/post/take-your-time/" data-toggle="tooltip" data-placement="top" title="Take your time.">Take your time.</a>
          <span class="blog-pagination-date"> <i class="fa fa-calendar-o" aria-hidden="true"></i> 02/16/160026</span>
        </li>
        
        
      </ul>

      <div class="disqus-comments">

	<div id="disqus_thread"></div>
	<script type="text/javascript">
		(function() {
		      
		      
		      if (window.location.hostname == "localhost")
		                return;

		      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		      var disqus_shortname = 'brainbaking';
		      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>


    </div>
  </div>
</div>

      
    </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/wgroeneveld" target="_blank" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
		      
          <li>
            <a href="mailto:wouter.groeneveld@gmail.com" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		      
	    	  
          
           
          
          
          
          
          <li>
            <a href="https://www.pinterest.com/woutergroenev" target="_blank" title="Pinterest">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-pinterest fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li>
            <a href="https://www.goodreads.com/user/show/5451893-wouter" target="_blank" title="Goodreads">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-book fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

    		  <li>
      			<a href="http://www.brainbaking.com/index.xml" title="RSS">
      			  <span class="fa-stack fa-lg">
        				<i class="fa fa-circle fa-stack-2x"></i>
        				<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      			  </span>
      			</a>
    		  </li>		

        </ul>
        <p class="credits copyright text-muted">
    	  <a href="http://www.brainbaking.com/about">Wouter Groeneveld</a>
    	  &nbsp;&bull;&nbsp;
    	  No copyright - <a href="https://github.com/wgroeneveld/brainbaking" target="_blank">Hack away!</a>
    		  
    	  
    	  &nbsp;&bull;&nbsp;
    	  <a href="http://www.brainbaking.com/">
          <i class="fa fa-lightbulb-o" aria-hidden="true"></i>&nbsp;Brain Baking
        </a>
    	  
  	    </p>
  	    
    	<p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.21</a> powered &nbsp;&bull;&nbsp; Theme by <a href="https://github.com/halogenica/beautifulhugo" target="_blank">Beautiful Hugo</a> adapted to <a href="https://github.com/wgroeneveld/beautifulbaking">Beautiful Baking</a>
          
    	</p>
      </div>
    </div>
  </div>
</footer>

<script src="http://www.brainbaking.com//js/jquery-1.11.2.min.js"></script>
<script src="http://www.brainbaking.com//js/bootstrap.min.js"></script>
<script src="http://www.brainbaking.com//js/main.js"></script>
<script src="http://www.brainbaking.com/js/highlight.min.js"></script>
<script async defer src="//assets.pinterest.com/js/pinit.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-45748221-1', 'auto');
ga('send', 'pageview');
</script>



  </body>
</html>
