<!DOCTYPE html>
<html lang="en-us">
    <head>
        <link rel="stylesheet" href="https://brainbaking.com/css/brainbaking.css">



	<meta name="description" content="Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt - Brain Baking">
	<meta content="Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt - Brain Baking" property="og:title">
	<meta content="Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt - Brain Baking" property="og:description">




<meta property="og:url" content="https://brainbaking.com/teaching/cpp/labo-10/" />
<meta property="og:type" content="website" />





<meta property="article:published_time" content="0001-01-01 00:00:00 &#43;0000 UTC" />
<meta property="article:modified_time" content="0001-01-01 00:00:00 &#43;0000 UTC" />
<meta property="article:section" content="teaching" />




<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://brainbaking.com/"
    },
    "articleSection" : "teaching",
    "name" : "Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt",
    
      "headline" : "Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt",
    
    "description" : "&laquo;&nbsp;Terug naar Software ontwerp in C/C++ &raquo;&nbsp;Naar de labo opgave
UI Frameworks De C++ taal is een krachtige tool om native code te compileren voor specifieke CPU en OS systemen. Daardoor is het ook vaak een logische keuze om complexe interfaces in te ontwerpen en ontwikkelen, van Photoshop tot Google Chrome. Interfaces brengen echter weer andere problemen met zich mee: elk besturingssysteem heeft ondertussen zijn eigen interpretatie.
De Windows standaard was MFC die de WinAPI wrapt, voor OSX was dit de Carbon API.",
    
      "inLanguage" : "nl-BE",
    
    
      "image": "https://brainbaking.com/img/avatar-icon.png",
    
    "author" : {
    	"@type": "Person",
    	"name": "Wouter Groeneveld"
	  },
    "publisher": {
    	"@type": "Organization",
    	"name": "Brain Baking",
    	"logo": {
    		"@type": "ImageObject",
    		"url": "https://brainbaking.com/img/avatar-icon.png"
    	}
	  },
    "accountablePerson" : "Wouter Groeneveld",
    "copyrightHolder" : "Wouter Groeneveld",
    "copyrightYear" : "0001",
    "datePublished": "2018-10-25 15:45:12 &#43;0200 CEST",
    "dateModified" : "2018-10-25 15:45:12 &#43;0200 CEST",
    "url" : "https://brainbaking.com/teaching/cpp/labo-10/",
    "wordCount" : "1299",
    "keywords" : [ "Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt", "teaching" ]
}
</script>



<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-45748221-1', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt</title>
        
        <style>

    html body {
        font-family: 'Source Serif Pro', sans-serif;
        background-color: white;
    }

    :root {
    	--accent: #008eb3;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://brainbaking.com/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source%20Serif%20Pro">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/paraiso-dark.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/cs.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/cpp.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scheme.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/llvm.min.js"></script> 

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.53" />
        
    </head>

    
    
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <body>
         
        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/post"><i class='fa fa-file-code-o'></i>&nbsp;Tech Blog</a></li>
                            
                                <li><a href="/essays"><i class='fa fa-book'></i>&nbsp;Essays</a></li>
                            
                                <li><a href="/tags"><i class='fa fa-tags'></i>&nbsp;Tags</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li><a href="/about"><i class='fa fa-user'></i>&nbsp;About Me</a></li>
                            
                                <li><a href="/teaching"><i class='fa fa-graduation-cap'></i>&nbsp;Teaching</a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>




<main>

    <a name="top"></a>
    <div class="item">

    
    <h3>
        
        <a href="/teaching/cpp/labo-10/">Labo 10: Een introductie in GUI ontwerp met C&#43;&#43; in Qt</a>
    </h3>
    

    
    
    


    
    

</div>


    <br> <div class="text-justify">

<p>&laquo;&nbsp;<a href="/teaching/cpp">Terug naar Software ontwerp in C/C++</a><br/>
&raquo;&nbsp;<a href="#oef">Naar de labo opgave</a></p>

<h2 id="ui-frameworks">UI Frameworks</h2>

<p>De C++ taal is een krachtige tool om native code te compileren voor specifieke CPU en OS systemen. Daardoor is het ook vaak een logische keuze om complexe interfaces in te ontwerpen en ontwikkelen, van Photoshop tot Google Chrome. Interfaces brengen echter weer andere problemen met zich mee: elk besturingssysteem heeft ondertussen zijn eigen interpretatie.</p>

<p>De Windows standaard was MFC die de WinAPI wrapt, voor OSX was dit de Carbon API. Ondertussen zijn beide frameworks vervangen door WPF (Ook in C#) en Cocoa (enkel in Objective-C). Voor Linux waren er 2 grote Window Managers: KDE en Gnome, die beiden hun eigen UI framework implementeerden: Qt en GTK.</p>

<p>We betreden nu het domein van &ldquo;frameworks&rdquo;: libraries die we samen met een programmeertaal gebruiken om sneller tot het gewenst resultaat te komen. Het zou nogal dom zijn om elke keer opnieuw een Button in de UI te moeten &ldquo;uitvinden&rdquo; - die zijn gewoon meegeleverd als predefined klasse in elk framework.</p>

<p>Wat is een Framework?</p>

<blockquote>
<p>a basic structure underlying a system, concept, or text.</p>
</blockquote>

<p>In ons geval een set van libraries waar we mee linken (met <code>g++</code>) zodat we <code>#include &lt;ui_component.h&gt;</code> in onze code kunnen gebruiken zonder die zelf te moeten maken. Dat brengt buiten een hoop componenten en includes, een aantal erg belangrijke <strong>nadelen</strong> met zich mee:</p>

<ol>
<li>Frameworks leggen vaak een stricte structuur op. Code moet op een bepaalde manier geschreven zijn, zoals voor Qt de <code>Q_OBJECT</code> macro in je klasse.</li>
<li>Frameworks leven: ze ontstaan, groeien en gaan dood. Dat betekent dat wij als ontwikkelaar een doordachte keuze moeten maken, en na x jaar ons moeten aanpassen.</li>
</ol>

<p>Qt en GTK zijn <em>cross-platform</em> UI frameworks: die kan je zowel op UNIX als op Windows compilen. Schrijf je je programma met behulp van Qt, dan zal (met minimale aanpassingen) het zowel voor UNIX als voor Windows kunnen compileren, en dan zal je doelpubliek vergroten. Qt werkt zelfs op <a href="http://doc.qt.io/qt-5/ios-support.html">iOS</a> en <a href="http://doc.qt.io/qt-5/android-support.html">Android</a> - dus waarom ooit Android-specifieke Widgets leren?</p>

<h2 id="het-qt-ecosysteem">Het Qt ecosysteem</h2>

<p><a href="https://www.qt.io/download">Download Qt</a> hier. Je zal merken dat 2gb aan HDD ruimte opgeslokt wordt: dat is erg veel voor een framework! Er zit echter een gigantische hoeveelheid aan bruikbare spullen in:</p>

<ul>
<li>Standaard UI componenten</li>
<li>2D en 3D rendering in OpenGL</li>
<li>Een SQL object-mapper interface naar verschillende databases</li>
<li>XML, JSON, &hellip; support</li>
<li>Mobile OS support</li>
<li>Web specifieke componenten</li>
<li>Netwerk integratie</li>
<li>Een eigen concurrency model</li>
<li>&hellip;</li>
</ul>

<p>Met als belangrijkste extra&rsquo;s Qt Designer en Qt Creator, de grafische UI designer (zoals je SceneGraph kent van JavaFX) en een hele eigen IDE.</p>

<p><img src="/img/teaching/qtcreator.png" class="bordered" /></p>

<h2 id="een-minimale-interface-ontwerpen">Een minimale interface ontwerpen</h2>

<p>Er zijn zéér veel goede Qt tutorials te vinden, waaronder:</p>

<ul>
<li>De ingebouwde tutorials bij het opstarten van Qt Creator</li>
<li>Qt.io: <a href="https://wiki.qt.io/Qt_for_Beginners">Qt for beginners</a></li>
<li>Qt.io: <a href="https://wiki.qt.io/New_Signal_Slot_Syntax">Signal Slot syntax</a></li>
<li>YouTube: <a href="https://www.youtube.com/watch?v=VigUMAfE2q4">Qt for beginners video series</a></li>
<li>BogoToBogo <a href="http://www.bogotobogo.com/Qt/Qt5_MainWindowTriggerAction.php">Qt5 tutorials</a></li>
</ul>

<p>De beste manier om te leren hoe Qt werkt is met experimentjes in de Creator.</p>

<h3 id="de-layout-van-een-qt-applicatie">De layout van een Qt applicatie</h3>

<p>In de main.cpp file zal je altijd dit vinden:</p>

<pre><code class="language-C">#include &quot;mainwindow.h&quot;
#include &lt;QApplication&gt;

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    MainWindow w;
    w.show();

    return a.exec();
}
</code></pre>

<p>Dit noemen we het <strong>bootstrappen</strong> van de Qt applicatie waarbij je een specifiek scherm aanmaakt en toont. <code>a.exec()</code> blokkeert de main thread totdat de UI stopt (bij het afsluiten van alle schermen bijvoorbeeld).</p>

<p><code>MainWindow</code> is een subklasse van <code>QMainWindow</code>:</p>

<pre><code class="language-C">namespace Ui {
  class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = nullptr);
    ~MainWindow();

private slots:
    void on_slider_sliderMoved(int position);

private:
    Ui::MainWindow *ui;
};
</code></pre>

<p>Merk hier framework-specifieke zaken op:</p>

<ol>
<li>De <code>Q_OBJECT</code> macro moet in elk Qt object aanwezig zijn dat <em>signals</em> en <em>slots</em> gebruikt.</li>
<li>Een private reference naar&hellip; jezelf? De Qt Designer genereert code! De forward reference is een reference naar een gegenereerde header file die je zelf nooit mag wijzigen.</li>
<li>De <code>private slots</code> accessor bestaat natuurlijk niet in C++. Qt voorziet een aparte plek om slots te definiëren.</li>
</ol>

<p>Qt genereert deze code voor jou - de destructor verwijdert de onderliggende ui pointer met <code>delete</code>.</p>

<p>In de source file include je beide headers:</p>

<pre><code class="language-C">#include &quot;mainwindow.h&quot;
#include &quot;ui_mainwindow.h&quot;

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);
}
</code></pre>

<p>De <code>setupUi</code> methode voegt de componenten toe aan het scherm die jij met de Qt Designer op het scherm gesleept hebt. Dankzij deze (ietwat vreemde) manier kan je overal in <code>MainWindow</code> met de <code>ui-&gt;</code> pointer reference aan componten geraken. Merk op dat je dus géén definities van componenten in je eigen header terugziet, die leven allemaal in <code>ui_mainwindow.h</code>.</p>

<h3 id="slots-en-signals">Slots en Signals</h3>

<p>Een actie aan een knop hangen kan op twee manieren: in de Designer of manueel. In beide gevallen gebruik je Qt&rsquo;s <strong>slots</strong> en <strong>signals</strong>. Een &ldquo;Signal&rdquo; is een bericht dat uitgestuurd wordt, waarop eender wie kan luisteren. Een &ldquo;slot&rdquo; definiëert de ruimte die gebruikt wordt om dat signaal op te vangen. Het concept is hetzelfde als het <strong>observer pattern</strong>.</p>

<p>De volgende code verbindt een progress bar <code>valueChanged</code> slot met een C++11 lambda callback als signal:</p>

<pre><code class="language-C">    connect(ui-&gt;progress, &amp;QProgressBar::valueChanged, [](const int &amp;newVal) {
        std::cout &lt;&lt; newVal &lt;&lt; std::endl;
    });
</code></pre>

<p>Dit kan je zelf in de constructor van je window toevoegen. <code>connect</code> geeft een <code>QMetaObject::Connection</code> object terug, zodat je dit kan disconnecten wanneer je zelf wilt.</p>

<p>Een eenvoudigere manier om zaken met elkaar te verbinden is via de UI designer rechtermsuiknop op een element -&gt; &ldquo;Go to slot&hellip;&rdquo; en een voorstel selecteren. Op dat moment wordt de juiste slot code gegenereerd.</p>

<p>Vergeet <code>Q_OBJECT</code> niet als je gebruik maakt van slots en signals.</p>

<h3 id="qt-s-objectenboom">Qt&rsquo;s objectenboom</h3>

<p>Elk UI object leidt af van <code>QObject</code>, net zoals in JavaFX. De <a href="http://doc.qt.io/qt-5/hierarchy.html">Qt Inheritance Hierarchy</a> is in de documentatie beschikbaar, waarvan voor ons de belangrijkste klassen bijvoorbeeld <code>QTextEdit</code> en <code>QLabel</code> zijn:</p>

<link href="/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
<script defer src="/mermaid/mermaid.min.js">
	mermaid.initialize({
		startOnLoad: true,
		flowchart: {
			useMaxWidth: true
		}
	});
</script>
<div class="mermaid" align="center" >
	
graph TD;
  A[QObject]
  B[QThread]
  C[QWidget]
  D[QFrame]
  E[QProgressBar]
  F[QLabel]
  G[QAbstractScrollArea]
  H[QTextEdit]
  I[QGraphicsView]
  J[QAbstractButton]
  K[QPushButton]
  L[QRadioButton]
  B --> A
  C --> A
  D --> C
  E --> C
  F --> D
  G --> D
  I --> G
  H --> G
  J --> C
  K --> J
  L --> J

</div>

<p>Voor een eigen widget implementatie lijkt ons overerven van <code>QWidget</code> dus een goede keuze.</p>

<h2 id="een-kijkje-achter-de-c-extensions">Een kijkje achter de C++ extensions</h2>

<p>Waar dient die vreemde macro nu eigenlijk voor? Hoe werkt <code>private slots:</code>? Qt gebruikt een Meta-Object Compiler (<a href="http://doc.qt.io/qt-5/moc.html">MOC</a>). Dit programma scant header files en genereert C++ source files met metadata die nodig is om onder andere:</p>

<ul>
<li>Slots en signals te laten werken (<code>signal:</code>)</li>
<li>Dynamische properties te kunnen gebruiken (<code>Q_PROPERTY</code>)</li>
<li>Run-time type informatie te kunnen lezen (<code>Q_CLASSINFO</code>)</li>
</ul>

<p>Die gegenereerde source file moet ook meegecompileerd worden. Qt projecten worden meestal met <code>QMake</code> gecompileerd die de MOC automatisch afhandelt. Lees ook <a href="http://doc.qt.io/qt-5/why-moc.html">Why Does Qt Use Moc for Signals and Slots?</a></p>

<p>Qt komt met een eigen <code>Makefile</code> generator in de vorm van <code>QMake</code> in plaats van <code>CMake</code> dat centraal staat in CLion. <a href="https://stackoverflow.com/questions/30235175/how-to-configure-clion-ide-for-qt-framework">Het is mogelijk</a> om CLion Qt projecten te laten builden gegeven enkele wijzigingen in de <code>CMakeLists.txt</code> file om Qt libraries te linken. Het probleem is echter de gegenereerde source files door MOC. Dit zou ons echter te ver leiden.</p>

<h2 id="a-name-oef-a-labo-oefeningen"><a name="oef"></a>Labo oefeningen</h2>

<ol>
<li>Maak een programma dat de gebruiker 2 breuken laat ingeven in de vorm van 4 aparte textfields. Een knop &ldquo;som&rdquo; drukt het resultaat af in een output textfield. Valideer de input en geef een foutboodschap in de vorm van een <code>QMessageBox</code> indien een ongeldige waarde ingegeven.</li>
<li>Als uitbreiding moet een tweede window openen die bereken knoppen bevat als een rekenmachine. Scherm 1: input fields, output. Scherm 2: knop &ldquo;plus&rdquo;, knop &ldquo;maal&rdquo;. Het tweede scherm kan men openen via een menu &ldquo;Bestand -&gt; Acites&rdquo; in scherm 1.<br /></li>
</ol>

<h2 id="denkvragen">Denkvragen</h2>

<ol>
<li>Beargumenteer waarom ik als software ontwikkelaar voor een UI framework als Qt zou kiezen in plaats van het <em>native</em> alternatief voor mijn ontwikkelplatform. Zijn hier ook nadelen aan verbonden?</li>
<li>Hoe komt het dat ik <code>connect()</code> in de constructor van een <code>QMainWindow</code> klasse kan uitvoeren? Waar is deze methode gedefiniëerd?</li>
</ol>
</div>

    
    

    

    
    

    <i class='fa fa-arrow-circle-o-up'></i>&nbsp;<a href="#top">Top</a> 

</main>

        <footer>

            <p class="copyright text-muted">No <i class='fa fa-copyright'></i> reserved - sharing is caring. <i class='fa fa-github'></i> <a href='https://github.com/wgroeneveld/brainbaking/'>Hack away</a>! <i class='fa fa-lightbulb-o'></i> <a href='/'>Brain Baking</a></p>

        </footer>
       
    </body>

</html>

